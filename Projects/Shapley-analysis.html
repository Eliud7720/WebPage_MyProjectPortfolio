<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My project portafolio</title>

    <!-- Import sytiling-->
    <link rel="stylesheet" href="style.css">

    <!-- Linking Font Awsome for icons-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

    <!-- Linking for swiper-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.css">
</head>
<body>

    <!-- Header /Navbar-->
    <header>
        <nav class="navbar">

            <!-- Name -->
            <a href="../index.html" class="nav-logo">
            <h2 class="nav-EliudName">ELIUD AGUILAR</h2>
            <h2 class="nav-project">PROJECT PORTFOLIO ðŸ“‚</h3>
            </a>

            <!-- Menu -->
            <ul class="navbar-Menu">

                <!-- Menu elements -->
                <button id="nav-close-button" class="fas fa-times"></button>
                <li clas="nav-item"> <a href="../index.html#Eliud" class = "nav-link">Who am I?</a></li>
                <li clas="nav-item"> <a href="../index.html#projects" class = "nav-link">Projects</a></li>
                <li clas="nav-item"> <a href="../index.html#Resume" class = "nav-link">Resume</a></li>
            </ul>

            <button id="nav-open-button" class="fas fa-bars"></button>

        </nav>
    </header>


    <main>

        <!-- Project section-->
         <section class="Project">

            <h1 class="main-title"> Shapley analysis to determine the most relevant molecular descriptors and their relationship with biological activity on proteins - Thesis project part 5</h1>
            <hr class="main-hr">

            <div class="about-and-objective">

                <div class="about">
                    <h2 class="about-title">
                        About this project
                    </h2>
                    <hr class="tinyhr">
                    <p class="about-description">
                        Once the best models and the types of descriptors that generally provide the most effective machine learning predictions are identified, one key task is to <strong>understand why these models reach their conclusions</strong>. Some models are naturally interpretable, such as <strong>linear models (logistic regression)</strong> or a simple <strong>decision tree</strong>. However, models like <strong>random forests, XGBoost, neural networks</strong>, and others are often considered <strong>black boxes</strong> because they lack inherent interpretability. A powerful way to analyze their behavior and understand the reasoning behind their predictions is through a <strong>Shapley analysis</strong>. Originating from <strong>economics and game theory</strong>, Shapley analysis is used to fairly distribute the value generated by a group of players according to their individual contributions. In this context, the <strong>Shapley value</strong> for a feature indicates <strong>how much the prediction improves or worsens</strong> when that feature is added to any subset of features.
                </div>

                <div class="objective">
                    <h2 class="objective-title">
                        Objective
                    </h2>
                    <hr class="tinyhr">
                    <p class="about-description">
                        Develop a <strong>Shapley analysis</strong> to determine and explain the <strong>contributions of each descriptor</strong> toward the <strong>target variable (activity)</strong> for each protein across all types of <strong>molecular descriptors</strong>.
                    </p>
                </div>

            </div>

            <h2 class="Development-title"> Development </h1>
            <hr class="main-hr">

            
            <h3 class="subtitle-raw">
                Data collection
            </h3>

            <p class="raw-text">
                The data used for this analysis were those obtained from the training of the machine learning models in Part 3. In this work, the <strong>Shapley analysis</strong> was performed only on the <strong>random forest models</strong>, as analyzing all models would generate an overwhelming number of plots. Therefore, only the <strong>random forest models</strong> for each type of <strong>molecular descriptor</strong> trained with the <strong>best determined hyperparameters</strong> were employed.
            </p>


            <h3 class="subtitle-raw">
                Consensus model based in top 5 models
            </h3>

            <p class="raw-text">
                The <strong>consensus model</strong> is developed by first selecting the <strong>5 best-performing models</strong> for each protein and loading the corresponding <strong>test data for the three descriptor types</strong> to ensure consistent predictions. Each of the 5 models then generates <strong>probabilities of being "active"</strong> using exactly the same test data. For each sample, the <strong>average probability</strong> across the 5 models is calculated, and if this average is â‰¥ 0.5, the sample is classified as <strong>active</strong>; otherwise, it is classified as <strong>inactive</strong>. This approach <strong>leverages multiple models</strong> to improve prediction reliability while ensuring that the <strong>same test data</strong> is used for all models, regardless of the descriptor type.
            </p>

            <p class="raw-text">
                The <strong>consensus model evaluation</strong> was performed in the same way as the individual models, since it now produces only a <strong>list of predictions with 0 and 1</strong> (inactive and active). The corresponding <strong>Scikit-learn libraries</strong> were used to assess the model using the <strong>same metrics</strong> as those applied to the individual models.
            </p>

            <p class="raw-text">
                The next table shows an example of a prediction with this model
            </p>

            <img src="projects_images\Consensus-model\Simple-average.png" alt="Simple-average" style="width:auto; height: 80px;">

            <h3 class="subtitle-raw">
                Consensus model based in weights
            </h3>

            <p class="raw-text">
                  For the <strong>weighted model</strong>, all <strong>15 machine learning models</strong> were considered. Instead of a simple average, a <strong>weighted average</strong> was computed, where each prediction was multiplied by its corresponding weight, and the sum of all provided the final model output. Similarly, if the result was â‰¥ 0.5, it was classified as <strong>1 (active)</strong>; otherwise, as <strong>0 (inactive)</strong>. Since these are now <strong>simple classifications</strong>, <strong>Scikit-learn</strong> was also used to evaluate the model's performance using standard metrics.
            </p>

            <p class="raw-text">
                The next table shows an example of a prediction with this model
            </p>

            <img src="projects_images\Consensus-model\Weighted-average.png" alt="Simple-average" style="width:auto; height: 100px;">

            <h3 class="subtitle-raw">
                Models results
            </h3>

            <p class="raw-text">
                The results of both the top-5 based model and the kiss-based models for each of the proteins are shown below (accuracy only)
            </p>

            <img src="projects_images\Consensus-model\Results.png" alt="Results" style="width:auto; height: 400px;">

            <p class="raw-text">
                 As shown in the previous figure, the results of the <strong>best original individual models</strong> outperformed the <strong>consensus models</strong>. This is expected and has been discussed in multiple studies and articles. The book <strong>Introduction to Machine Learning with Python</strong> explains that the only consensus models that are consistently effective are those involving <strong>decision tree ensembles</strong>, such as <strong>Random Forest</strong> and <strong>gradient boosting</strong>.
            </p>


            <h2 class="Development-title"> Conclusions </h1>
            <hr class="main-hr">

            <ul class = "Conclusions_list">
            <li>The project explored whether a <strong>consensus strategy</strong> could improve the performance of machine learning models trained for each protein.</li>
            <li>Two consensus strategies were implemented: <strong>top-5 model average</strong> and <strong>weighted average of all 15 models</strong> based on individual model performance.</li>
            <li>Machine learning models with optimized hyperparameters were saved using <strong>joblib</strong>, and a <strong>DataFrame</strong> was created to track models and their performance for weighted predictions.</li>
            <li>The <strong>top-5 consensus model</strong> calculates probabilities of being active from the 5 best models, averages them, and classifies samples as active if the average â‰¥ 0.5, otherwise inactive.</li>
            <li>The <strong>weighted consensus model</strong> considers all 15 models, multiplies each prediction by its weight, sums them, and classifies based on a 0.5 threshold.</li>
            <li>Both consensus models were evaluated using <strong>Scikit-learn metrics</strong> in the same way as individual models.</li>
            <li>Results showed that the <strong>best original individual models outperformed the consensus models</strong>, which is consistent with observations in literature.</li>
            <li>The book <strong>Introduction to Machine Learning with Python</strong> notes that only consensus models using <strong>decision tree ensembles</strong> (Random Forest, Gradient Boosting) are consistently effective.</li>
            </ul>
            


         </section>

 
        <!-- My footer-->
        <footer class="site-footer">
            Eliud Aguilar Project Portfolio Â©
        </footer>

    </main>
    


    <!--Custom Script-->
    <script src = "script.js" ></script>

    <!--Swipper script-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js"></script>
    
</body>
</html>