<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My project portafolio</title>

    <!-- Import sytiling-->
    <link rel="stylesheet" href="style.css">

    <!-- Linking Font Awsome for icons-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

    <!-- Linking for swiper-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.css">

    <!-- Favico styling-->
    <link rel="icon" type="image/png" href="../images/base/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="../images/base/favicon.svg" />
    <link rel="shortcut icon" href="../images/base/favicon.ico" />
    <link rel="manifest" href="../images/base/site.webmanifest" />



</head>
<body>

    <!-- Header /Navbar-->
    <header>
        <nav class="navbar">

            <!-- Name -->
            <a href="../index.html" class="nav-logo">
            <h2 class="nav-EliudName">ELIUD AGUILAR</h2>
            <h2 class="nav-project">PROJECT PORTFOLIO ðŸ“‚</h3>
            </a>

            <!-- Menu -->
            <ul class="navbar-Menu">

                <!-- Menu elements -->
                <button id="nav-close-button" class="fas fa-times"></button>
                <li clas="nav-item"> <a href="../index.html#Eliud" class = "nav-link">Who am I?</a></li>
                <li clas="nav-item"> <a href="../index.html#projects" class = "nav-link">Projects</a></li>
                <li clas="nav-item"> <a href="../index.html#Resume" class = "nav-link">Resume</a></li>
            </ul>

            <button id="nav-open-button" class="fas fa-bars"></button>

        </nav>
    </header>


    <main>

        <!-- Project section-->
         <section class="Project">

            <h1 class="main-title"> Shapley analysis to determine the most relevant molecular descriptors and their relationship with biological activity on proteins - Thesis project part 5</h1>
            <hr class="main-hr">

            <div class="about-and-objective">

                <div class="about">
                    <h2 class="about-title">
                        About this project
                    </h2>
                    <hr class="tinyhr">
                    <p class="about-description">
                        Once the best models and the types of descriptors that generally provide the most effective machine learning predictions are identified, one key task is to <strong>understand why these models reach their conclusions</strong>. Some models are naturally interpretable, such as <strong>linear models (logistic regression)</strong> or a simple <strong>decision tree</strong>. However, models like <strong>random forests, XGBoost, neural networks</strong>, and others are often considered <strong>black boxes</strong> because they lack inherent interpretability. A powerful way to analyze their behavior and understand the reasoning behind their predictions is through a <strong>Shapley analysis</strong>. Originating from <strong>economics and game theory</strong>, Shapley analysis is used to fairly distribute the value generated by a group of players according to their individual contributions. In this context, the <strong>Shapley value</strong> for a feature indicates <strong>how much the prediction improves or worsens</strong> when that feature is added to any subset of features.
                </div>

                <div class="objective">
                    <h2 class="objective-title">
                        Objective
                    </h2>
                    <hr class="tinyhr">
                    <p class="about-description">
                        Develop a <strong>Shapley analysis</strong> to determine and explain the <strong>contributions of each descriptor</strong> toward the <strong>target variable (activity)</strong> for each protein across all types of <strong>molecular descriptors</strong>.
                    </p>
                </div>

            </div>

            <h2 class="Development-title"> Development </h1>
            <hr class="main-hr">

            
            <h3 class="subtitle-raw">
                Data collection
            </h3>

            <p class="raw-text">
                The data used for this analysis were those obtained from the training of the machine learning models in Part 3. In this work, the <strong>Shapley analysis</strong> was performed only on the <strong>random forest models</strong>, as analyzing all models would generate an overwhelming number of plots. Therefore, only the <strong>random forest models</strong> for each type of <strong>molecular descriptor</strong> trained with the <strong>best determined hyperparameters</strong> were employed.
            </p>


            <h3 class="subtitle-raw">
                Shapley analysis
            </h3>

            <p class="raw-text">
                The <strong>Shapley analysis</strong> was conducted on both types of <strong>molecular descriptors</strong> (<strong>Rdkit</strong> and <strong>Mordred</strong>) for each protein. The <strong>random forest models</strong> trained with the <strong>best hyperparameters</strong> were loaded using Python's <strong>joblib</strong> library. Additionally, each type of <strong>molecular descriptor</strong>, both Rdkit and Mordred, was loaded for the analysis.
            </p>

            <p class="raw-text">
                Once the data were loaded and the <strong>best features</strong> had already been identified (according to <strong>random forest</strong>), the focus was on generating the <strong>Shapley beeswarm plot</strong>, which is the most applicable in these cases. The <strong>shap</strong> library was used to perform the analysis. The <strong>shap.Explanation</strong> function was employed, followed by plotting using <strong>shap.plots.beeswarm</strong>.
            </p>

            <p class="raw-text">
                Below is the <strong>beeswarm plot</strong> for the <strong>Random Forest model</strong> using the <strong>RDKIT molecular descriptors</strong>.
            </p>

            <img src="projects_images\Shapley-tesis\Shapley-plot-example.png" alt="Shapley-example" style="width:auto; height:450px;">

            <p class="raw-text">
                <strong>Red values</strong> indicate relatively high values for each feature. For example, if a feature ranges from 0 to 25, red values are close to 25, while <strong>blue values</strong> are near 0. The position of each point to the left or right of the X-axis represents whether the feature contributes <strong>negatively or positively</strong> to the probability of belonging to <strong>class 1</strong>. For instance, in the previously shown image, the first feature <strong>SlogP_VSA10</strong> shows that high values tend to <strong>positively contribute</strong> to the probability of being class 1, while low values contribute negatively. Conversely, for <strong>SlogP_VSA8</strong>, the effect is exactly the opposite.
            </p>

            <h3 class="subtitle-raw">
                Results
            </h3>

            <p class="raw-text">
                This analysis was conducted on <strong>all proteins</strong>. Finally, only the <strong>top 5 features</strong> were reported, along with their <strong>relative importance</strong>, <strong>contribution</strong>, and a brief explanation of how each feature functions <strong>chemically</strong>. Below, the corresponding tables are presented  only for the EGFR protein, organized by <strong>descriptor type</strong>.
            </p>

            <p class="raw-text">
                EGFR shapley analysis using RDKIT descriptors
            </p>

            <img src="projects_images\Shapley-tesis\Shapley-EGFR-Rdkit.png" alt="Shapley-rdkit" style="width:auto; height:250px;">

            <p class="raw-text">
                EGFR shapley analysis using Mordred descriptors
            </p>

            <img src="projects_images\Shapley-tesis\Shapley-EGFR-Mordred.png" alt="Shapley-mordred" style="width:auto; height:250px;">





            <h2 class="Development-title"> Conclusions </h1>
            <hr class="main-hr">

            <ul class = "Conclusions_list">
            <li>The <strong>Shapley analysis</strong> successfully identified the <strong>most relevant molecular descriptors</strong> that influence protein activity, providing insight into how each feature contributes to the predictions of Random Forest models.</li>
            <li>Using both <strong>Rdkit and Mordred descriptors</strong>, the analysis highlighted that different features can have <strong>opposite contributions</strong> to the probability of class membership, emphasizing the importance of feature-specific interpretation.</li>
            <li>By focusing on the <strong>top 5 features</strong> per protein, the study allowed for a clear and chemically meaningful explanation of the descriptors' impact, making complex models like Random Forest more <strong>interpretable</strong>.</li>
            </ul>
            


         </section>

 
        <!-- My footer-->
        <footer class="site-footer">
            Eliud Aguilar Project Portfolio Â©
        </footer>

    </main>
    


    <!--Custom Script-->
    <script src = "script.js" ></script>

    <!--Swipper script-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js"></script>
    
</body>
</html>