<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My project portafolio</title>

    <!-- Import sytiling-->
    <link rel="stylesheet" href="style.css">

    <!-- Linking Font Awsome for icons-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

    <!-- Linking for swiper-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.css">

    <!-- Favico styling-->
    <link rel="icon" type="image/png" href="../images/base/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="../images/base/favicon.svg" />
    <link rel="shortcut icon" href="../images/base/favicon.ico" />
    <link rel="manifest" href="../images/base/site.webmanifest" />

        
</head>
<body>

    <!-- Header /Navbar-->
    <header>
        <nav class="navbar">

            <!-- Name -->
            <a href="../index.html" class="nav-logo">
            <h2 class="nav-EliudName">ELIUD AGUILAR</h2>
            <h2 class="nav-project">PROJECT PORTFOLIO ðŸ“‚</h3>
            </a>

            <!-- Menu -->
            <ul class="navbar-Menu">

                <!-- Menu elements -->
                <button id="nav-close-button" class="fas fa-times"></button>
                <li clas="nav-item"> <a href="../index.html#Eliud" class = "nav-link">Who am I?</a></li>
                <li clas="nav-item"> <a href="../index.html#projects" class = "nav-link">Projects</a></li>
                <li clas="nav-item"> <a href="../index.html#Resume" class = "nav-link">Resume</a></li>
            </ul>

            <button id="nav-open-button" class="fas fa-bars"></button>

        </nav>
    </header>


    <main>

        <!-- Project section-->
         <section class="Project">

            <h1 class="main-title"> Iris data model training with PySpark</h1>
            <hr class="main-hr">

            <div class="about-and-objective">

                <div class="about">
                    <h2 class="about-title">
                        About this project
                    </h2>
                    <hr class="tinyhr">
                    <p class="about-description">
                        The <strong>IRIS dataset</strong> is a well-known dataset widely used to teach <strong>classification models</strong> in machine learning. While it is commonly employed with libraries like <strong>Scikit-learn</strong> or platforms such as <strong>KNIME</strong>, it is also important to demonstrate proficiency with <strong>big data tools</strong>, such as <strong>Apache Spark</strong> and its Python interface, <strong>PySpark</strong>. In this project, I showcase my results training various <strong>machine learning models</strong> on the IRIS dataset using multiple algorithms in <strong>PySpark</strong>.
                </div>

                <div class="objective">
                    <h2 class="objective-title">
                        Objective
                    </h2>
                    <hr class="tinyhr">
                    <p class="about-description">
                        Train and evaluate <strong>machine learning models</strong> using <strong>PySpark MLlib</strong> on the well-known <strong>IRIS dataset</strong>.
                </div>

            </div>

            <h2 class="Development-title"> Development </h1>
            <hr class="main-hr">

            
            <h3 class="subtitle-raw">
                Data collection
            </h3>

            <p class="raw-text">
                The <strong>IRIS dataset</strong> is widely used to teach <strong>classification models</strong> with the <strong>Scikit-learn</strong> library. It contains records (<strong>Y</strong>) for three species: <strong>Iris versicolor</strong>, <strong>Iris setosa</strong>, and <strong>Iris virginica</strong>. The features include the <strong>length and width of both the sepal and petal</strong> for each plant. You can learn more about this dataset and download it from the following link: https://www.kaggle.com/datasets/uciml/iris
            </p>

            <h3 class="subtitle-raw">
                Load PySpark Session
            </h3>

            <p class="raw-text">
                First, a <strong>Spark session</strong> was created and named <strong>"Iris_with_PySpark"</strong>. This allows monitoring the jobs assigned to PySpark and observing how they are executed. The following image shows the <strong>Spark UI</strong> on the <strong>Spark Jobs</strong> tab:
            </p>

            <img src="projects_images\pyspark-iris\PySpark-iris.png" alt="PySpark-screenshot" style="width:auto; height: 300px;">

            <h3 class="subtitle-raw">
                Load data
            </h3>

            <p class="raw-text">
                The data was loaded into a <strong>Spark DataFrame</strong> using <code>spark.createDataFrame</code>, and the number of <strong>rows and columns</strong> was counted.
            </p>

            <table border="1"> <tr> <th>Rows</th> <th>Columns</th> </tr> <tr> <td>150</td> <td>5</td> </tr> </table>

            <p class="raw-text">
                The dataset contains 5 columns: sepal length (cm), sepal width (cm), petal length (cm), petal width (cm), label.
            </p>

            <h3 class="subtitle-raw">
                Exploratory Data Analysis
            </h3>

            <p class="raw-text">
                The dataset does not require an extensive <strong>Exploratory Data Analysis (EDA)</strong> as it is very simple and has been widely explained in numerous tutorials. Using <strong>PySpark</strong>, the <code>describe</code> function, similar to <code>pandas</code>, provides a summary in the form of <strong>descriptive statistics</strong>.
            </p>

            <img src="projects_images\pyspark-iris\descriptive-data-pyspark.png" alt="PySpark-screenshot" style="width:auto; height: 150px;">

            <p class="raw-text">
                However, unlike <code>pandas</code>, PySpark's <code>describe</code> does not return quantile information. To obtain this, you can use the <code>approxQuantile</code> function and provide a list of the desired percentiles or deciles as parameters.
            </p>

            <p class="raw-text">
                The following table presents the <strong>results obtained</strong> at different <strong>quantiles</strong> for each <strong>feature</strong>.
            </p>

            <table border="1" cellpadding="5" cellspacing="0">
            <thead>
                <tr>
                <th>Feature</th>
                <th>Q0.01</th>
                <th>Q0.25</th>
                <th>Q0.5</th>
                <th>Q0.75</th>
                <th>Q0.99</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td>sepal length (cm)</td>
                <td>4.3</td>
                <td>5.1</td>
                <td>5.8</td>
                <td>6.4</td>
                <td>7.9</td>
                </tr>
                <tr>
                <td>sepal width (cm)</td>
                <td>2.0</td>
                <td>2.8</td>
                <td>3.0</td>
                <td>3.3</td>
                <td>4.4</td>
                </tr>
                <tr>
                <td>petal length (cm)</td>
                <td>1.0</td>
                <td>1.5</td>
                <td>4.3</td>
                <td>5.1</td>
                <td>6.9</td>
                </tr>
                <tr>
                <td>petal width (cm)</td>
                <td>0.1</td>
                <td>0.3</td>
                <td>1.3</td>
                <td>1.8</td>
                <td>2.5</td>
                </tr>
            </tbody>
            </table>

            <p class="raw-text">
                For <strong>categorical data</strong> such as <strong>species</strong>, it is common to perform a <strong>count of each class</strong>. To carry out a count in <strong>PySpark</strong>, you can use <strong>groupBy</strong> along with <strong>count</strong> and <strong>show</strong>:
            </p>

            <img src="projects_images\pyspark-iris\Categorical-data.png" alt= "Categorial-data" style="width:auto; height: 150px;">

            <p class="raw-text">
                As we can see in the previous tables, the data is <strong>balanced</strong>, since each <strong>category</strong> is represented <strong>equitably</strong>.
            </p>

            <p class="raw-text">
                It is not possible to create <strong>plots</strong> directly using <strong>PySpark</strong>. However, there is a method to convert a <strong>PySpark DataFrame</strong> to <strong>Pandas</strong> and then generate plots. The following plot shows a <strong>scatter diagram</strong> with only two <strong>features</strong>: <strong>sepal width</strong> and <strong>sepal length</strong>, with each point colored according to its <strong>class</strong>. This allows us to visualize the <strong>ranges</strong> covered by each class. We can observe that <strong>high sepal width</strong> and <strong>low sepal length</strong> correspond to <strong>class 0</strong>, and so on.
            </p>

            <img src="projects_images\pyspark-iris\Species.png" alt="Species" style="width:auto; height: 350px;">

            <h3 class="subtitle-raw">
                Model training
            </h3>

            <p class="raw-text">
                The data was transformed into a <strong>matrix</strong> using <strong>VectorAssembler</strong> to create <strong>features</strong> and <strong>labels</strong>. Subsequently, the data was split into two sets using <strong>randomSplit</strong> for <strong>training</strong> and <strong>testing</strong> with the standard 0.8 - 0.2 ratio. The <strong>machine learning algorithms</strong> <strong>Logistic Regression</strong> and <strong>Random Forest</strong> were trained with their respective <strong>MLlib instances</strong>. First, the <strong>best subset of hyperparameters</strong> was searched, and then each model was evaluated using this <strong>optimal hyperparameter subset</strong>. The best hyperparameteres were obtained using cross validation with cv = 5.
            </p>

            <p class="raw-text">
                The <strong>hyperparameter grid</strong> tested for each <strong>model</strong> is shown below:
            </p>

            <table border="1" cellpadding="5" cellspacing="0">
            <thead>
                <tr>
                <th>Model</th>
                <th>Hyperparameter</th>
                <th>Grid</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td>Logistic Regression</td>
                <td>regParam</td>
                <td>[0.01, 0.1, 1]</td>
                </tr>
                <tr>
                <td>Logistic Regression</td>
                <td>elasticNetParam</td>
                <td>[0.0, 0.5, 1.0]</td>
                </tr>
                <tr>
                <td>Random Forest</td>
                <td>numTrees</td>
                <td>[10, 50, 100]</td>
                </tr>
                <tr>
                <td>Random Forest</td>
                <td>maxDepth</td>
                <td>[5, 10, 15]</td>
                </tr>
            </tbody>
            </table>

            <h3 class="subtitle-raw">
                Model evaluation
            </h3>

            <p class="raw-text">
                The <strong>results</strong> of the <strong>best hyperparameters</strong> are shown in the table below:
            </p>

            <table border="1" cellpadding="5" cellspacing="0">
            <thead>
                <tr>
                <th>Model</th>
                <th>Hyperparameter</th>
                <th>Best value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td>Logistic Regression</td>
                <td>regParam</td>
                <td>0.01</td>
                </tr>
                <tr>
                <td>Logistic Regression</td>
                <td>elasticNetParam</td>
                <td>0</td>
                </tr>
                <tr>
                <td>Random Forest</td>
                <td>numTrees</td>
                <td>50</td>
                </tr>
                <tr>
                <td>Random Forest</td>
                <td>maxDepth</td>
                <td>10</td>
                </tr>
            </tbody>
            </table>

            <p class="raw-text">
                The <strong>models</strong> were evaluated with their respective <strong>best hyperparameters</strong> on the <strong>test set</strong> for the metrics: <strong>Accuracy</strong>, <strong>Precision</strong>, <strong>F1-score</strong>, and <strong>Recall</strong>. The <strong>results</strong> are shown in the table below.
            </p>

            <p class="raw-text">
                The <strong>results</strong> of the <strong>models</strong> across the different <strong>metrics</strong> are shown in the figure below.
            </p>

             <img src="projects_images\pyspark-iris\Models-performance.png" alt="Species" style="width:auto; height: 350px;">



            <h2 class="Development-title"> Conclusions </h1>
            <hr class="main-hr">

            <ul class = "Conclusions_list">
            <li><strong>Data Balance:</strong> The IRIS dataset used is <strong>well-balanced</strong>, with each species equally represented, ensuring fair training and evaluation of models.</li>
            <li><strong>Model Performance:</strong> Both <strong>Random Forest</strong> and <strong>Logistic Regression</strong> achieved high performance, with Random Forest slightly outperforming Logistic Regression across all metrics (Accuracy, Precision, F1-score, and Recall).</li>
            <li><strong>PySpark MLlib Usability:</strong> PySpark allows efficient training and hyperparameter tuning on the IRIS dataset, demonstrating its capability to handle machine learning workflows on structured data, even though visualization requires conversion to Pandas.</li>
            </ul>
            


         </section>

 
        <!-- My footer-->
        <footer class="site-footer">
            Eliud Aguilar Project Portfolio Â©
        </footer>

    </main>
    


    <!--Custom Script-->
    <script src = "script.js" ></script>

    <!--Swipper script-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js"></script>
    
</body>
</html>